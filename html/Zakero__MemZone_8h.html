<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Zakero&#39;s C++ Header Libraries: Zakero_MemZone.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Zakero&#39;s C++ Header Libraries
   </div>
   <div id="projectbrief">A collection of reusable C++ libraries</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">Zakero_MemZone.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Zakero MemZone.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
Include dependency graph for Zakero_MemZone.h:</div>
<div class="dyncontent">
<div class="center"><img src="Zakero__MemZone_8h__incl.png" border="0" usemap="#aZakero__MemZone_8h" alt=""/></div>
<map name="aZakero__MemZone_8h" id="aZakero__MemZone_8h">
<area shape="rect" title="Zakero MemZone." alt="" coords="169,5,321,31"/>
<area shape="rect" title=" " alt="" coords="5,79,72,104"/>
<area shape="rect" title=" " alt="" coords="97,79,167,104"/>
<area shape="rect" title=" " alt="" coords="191,79,299,104"/>
<area shape="rect" title=" " alt="" coords="323,79,426,104"/>
<area shape="rect" title=" " alt="" coords="451,79,525,104"/>
</map>
</div>
</div>
<p><a href="Zakero__MemZone_8h_source.html">Go to the source code of this file.</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">API   </td><td class="markdownTableBodyNone"><a class="el" href="Zakero__MemZone_8h.html#zakero_memzone_deps">Dependencies</a>   </td><td class="markdownTableBodyNone"><a class="el" href="Zakero__MemZone_8h.html#zakero_memzone_tldr">TL;DR</a>   </td><td class="markdownTableBodyNone"><a class="el" href="Zakero__MemZone_8h.html#zakero_memzone_what">What Is It?</a>   </td><td class="markdownTableBodyNone"><a class="el" href="Zakero__MemZone_8h.html#zakero_memzone_whys">Why Use It?</a>   </td><td class="markdownTableBodyNone"><a class="el" href="Zakero__MemZone_8h.html#zakero_memzone_hows">How To Use It?</a>   </td><td class="markdownTableBodyNone"><a class="el" href="Zakero__MemZone_8h.html#zakero_memzone_vers">Version</a>   </td></tr>
</table>
<p>Here, you will find information about and how to add the <em>Zakero_MemZone</em> to your project.</p>
<p><a class="anchor" id="zakero_memzone_deps"></a></p><dl class="section user"><dt>Dependencies</dt><dd><ul>
<li>None </li>
</ul>
</dd></dl>
<p><a class="anchor" id="zakero_memzone_tldr"></a></p><dl class="section user"><dt>TL;DR:</dt><dd><p class="startdd">This library will provide a memory pool for your application.</p>
<p class="enddd">To use:</p><ol type="1">
<li>Add the implementation to a source code file: <div class="fragment"><div class="line"><span class="preprocessor">#define ZAKERO_MEMZONE_IMPLEMENTATION</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Zakero__MemZone_8h.html">Zakero_MemZone.h</a>&quot;</span></div>
<div class="ttc" id="aZakero__MemZone_8h_html"><div class="ttname"><a href="Zakero__MemZone_8h.html">Zakero_MemZone.h</a></div><div class="ttdoc">Zakero MemZone.</div></div>
</div><!-- fragment --></li>
<li>Add the library to where it is used: <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Zakero__MemZone_8h.html">Zakero_MemZone.h</a>&quot;</span></div>
</div><!-- fragment --> </li>
</ol>
</dd></dl>
<p><a class="anchor" id="zakero_memzone_what"></a></p><dl class="section user"><dt>What Is It?</dt><dd><p class="startdd">The <em>Zakero MemZone</em> library will create and manage a region of memory. From this pool of memory, sections of memory can be allocated and freed without the overhead of the malloc family of function or the <code>new</code> operator.</p>
<p class="interdd">When memory is allocated a unique identifier is returned. This identifier must be used to access and use the memory. The reason for using the identifier is to provide a layer of indirection which allows <em>MemZone</em> to rearrange the allocated memory as needed.</p>
<p class="enddd">Programs are expected to be "good citizens" by not writing outside of their allocated area. </p>
</dd></dl>
<p><a class="anchor" id="zakero_memzone_whys"></a></p><dl class="section user"><dt>Why Use It?</dt><dd><p class="startdd">As with many things, there are benefits and draw backs to using a memory pool. For the MemZone object they are:</p>
<p class="interdd"><b>Benefits</b></p><ul>
<li>SPEED!!! Much faster allocations than <code>new</code> or <code>malloc</code></li>
<li>Data focused, allocations are based on size not object-type</li>
<li>The entire memory pool can be easily shared across process-space</li>
<li>Can automatically grow as needed [optional feature]</li>
</ul>
<p class="interdd"><b>Draw Backs</b></p><ul>
<li>Requires extra work to convert identifiers to pointers</li>
<li>No bounds checking in memory writes</li>
</ul>
<p class="interdd">To put things into perspective, allocating memory is a very expensive operation. Using the MemZone means this operation only needs to happen once. <br  />
 Allocating memory from the MemZone is also fast because MemZone tracks the amount and location of free memory.</p>
<p class="interdd">Unless C++'s <a href="https://en.cppreference.com/w/cpp/language/new#Placement_new">Placement New</a> is being used extensively, the developer must be fully aware of where they are in their area of the memory region so that other data is not over written.</p>
<p class="interdd">Memory fragmentation already happens in most applications. The impact of the fragmentation is not felt due to huge amounts of memory in today's computers. However, for smaller memory pools, fragmentation becomes a larger issue. Over the course of an application's life-time, memory allocation and freeing can occur many times. Eventually, a large block of memory is requested, that allocation may fail because a contiguous region of memory is not available. This is a common problem that plagues memory pools.</p>
<p class="enddd">To combat this problem, MemZone has defragmentation tools built-in which can be enabled automatically or called explicitly. </p>
</dd></dl>
<p><a class="anchor" id="zakero_memzone_hows"></a></p><dl class="section user"><dt>How To Use It?</dt><dd><p class="startdd"><b>Step 0</b></p>
<p class="interdd">Your compiler must support at least the C++20 standard. The location of the <code>Zakero_*.h</code> header files <em>must</em> be in your compiler's include path.</p>
<p class="interdd"><b>Step 1</b></p>
<p class="interdd">The first step is to select which C++ source code file will contain the <em>Zakero MemZone</em> implementation. Once the location has been determined, add the following to that file:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define ZAKERO_MEMZONE_IMPLEMENTATION</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Zakero__MemZone_8h.html">Zakero_MemZone.h</a>&quot;</span></div>
</div><!-- fragment --><p class="interdd">The macro ZAKERO_MEMZONE_IMPLEMENTATION tells the header file to include the implementation of the MemZone.</p>
<p class="interdd">In all other files that will use the MemZone, they need to include the header.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Zakero__MemZone_8h.html">Zakero_MemZone.h</a>&quot;</span></div>
</div><!-- fragment --><p class="interdd"><b>Step 2</b></p>
<p class="interdd">After creating MemZone, it must be initialized before it can be used. Once that is done, you can freely allocate and free memory from the MemZone.</p>
<p class="interdd">This is an example of creating two std::array's that are backed by the MemZone.</p>
<div class="fragment"><div class="line">zakero::MemZone memory_pool;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">size_t</span> count = 100;</div>
<div class="line"><span class="keywordtype">size_t</span> array_size = <span class="keyword">sizeof</span>(int64_t) * count;</div>
<div class="line"> </div>
<div class="line">Zakero_MemZone_Init(memory_pool, Zakero_MemZone_Mode_RAM, array_size * 3);</div>
<div class="line"> </div>
<div class="line">uint64_t array_1_id = 0;</div>
<div class="line">Zakero_MemZone_Allocate(memory_pool, array_size, array_1_id);</div>
<div class="line">int64_t* ptr = (int64_t*)Zakero_MemZone_Acquire(memory_pool, array_1_id);</div>
<div class="line"> </div>
<div class="line">std::array&lt;int64_t,count&gt;* array_1 = <span class="keyword">new</span>(ptr) std::array&lt;int64_t,count&gt;();</div>
<div class="line"> </div>
<div class="line">uint64_t array_2_id = 0;</div>
<div class="line">Zakero_MemZone_Allocate(memory_pool, array_size, array_2_id);</div>
<div class="line">ptr = (int64_t*)Zakero_MemZone_Acquire(memory_pool, array_2_id);</div>
<div class="line"> </div>
<div class="line">std::array&lt;int64_t,count&gt;* array_2 = <span class="keyword">new</span>(ptr) std::array&lt;int64_t,count&gt;();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Do stuff with array_1 and array_2</span></div>
<div class="line"> </div>
<div class="line">Zakero_MemZone_Release(memory_pool, array_1_id);</div>
<div class="line">Zakero_MemZone_Release(memory_pool, array_2_id);</div>
<div class="line"> </div>
<div class="line">Zakero_MemZone_Free(memory_pool, array_1_id);</div>
<div class="line">Zakero_MemZone_Free(memory_pool, array_2_id);</div>
</div><!-- fragment --> </dd></dl>
<p><a class="anchor" id="zakero_memzone_vers"></a></p><dl class="section user"><dt>Version</dt><dd><b>0.1.0</b><ul>
<li>The initial version </li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd><a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License v2</a></dd></dl>
<dl class="section author"><dt>Author</dt><dd>Andrew "Zakero" Moore<ul>
<li>Original Author</li>
</ul>
</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd><p class="startdd">Create a C++ version </p>
<p class="interdd">Add support for file-based memory </p>
<p class="interdd">Add support for shared memory </p>
<p class="interdd">Add more <code>todo</code> items </p>
<p class="enddd">Improve documentation</p>
</dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
